from srv6 import encap, monitor
from net import forward
from classifier import basic_classifier

fast_no_kernel = 1

def myChain1():
    encap(0x01)
    monitor(2)
    routing(fast_no_kernel)

def myChain2():
    encap(0x01)
    routing(fast_no_kernel)

def myChain3():
    monitor(2)
    myChain2()

basic_classifier["fc88::1"] = myChain1
basic_classifier["fc88::2"] = myChain2




############## C ################################
__section("__tpr_chain_mychain1")
int __tpr_chain_mychain1(struct xdp_md *ctx)
{
#define ENCAP_PROG_ID   0x0000f00l
#define MONITOR_PROG_ID 0x00008bad
#define ROUTING_PROG_ID 0x0000cafe
#define FAST_NO_KERNEL  1

    hike_call_1(ENCAP_PROG_ID, 0x01);
    hike_call_1(MONITOR_PROG_ID, 2);
    hike_call_1(ROUTING_PROG_ID, FAST_NO_KERNEL);

    return XDP_DROP;
}




     